# كيفية استخدام بوت الاستعلام عن بيانات الناخبين

## 📋 الخطوات السريعة

### 1️⃣ إعداد Google Sheet
1. افتح Google Sheets وأنشئ ملف جديد
2. أنشئ ورقة باسم **Voters** (مهم جداً)
3. ضع البيانات بهذا الشكل:

| العمود A | العمود B (الأرقام القومية) | العمود C (الأسماء) |
|---------|---------------------------|-------------------|
| ...     | 29012011234567            | أحمد محمد          |
| ...     | 29103011234568            | فاطمة علي          |

⚠️ **مهم**: 
- الأرقام القومية يجب أن تكون في **العمود B**
- الأسماء في **العمود C**
- الصف الأول (العناوين) سيتم تجاهله تلقائياً

4. من شريط العنوان، انسخ **معرف الملف (Spreadsheet ID)**
   - مثال: `https://docs.google.com/spreadsheets/d/1-rCGPx6vyEMm3zmR7ks3xZh63XcJk4ks78e5e9jfuyo/edit`
   - المعرف هو: `1-rCGPx6vyEMm3zmR7ks3xZh63XcJk4ks78e5e9jfuyo`

### 2️⃣ تحديث معرف Google Sheet في الكود
1. افتح ملف `main.py`
2. ابحث عن السطر:
   ```python
   SPREADSHEET_ID = "1-rCGPx6vyEMm3zmR7ks3xZh63XcJk4ks78e5e9jfuyo"
   ```
3. استبدل المعرف بمعرف ملفك الخاص

### 3️⃣ تشغيل البرنامج
البرنامج يعمل تلقائياً مع Dashboard!

**لعرض لوحة التحكم:**
- افتح الـ Webview في Replit
- ستظهر لك لوحة تحكم تعرض:
  - آخر صف معالج
  - إجمالي الصفوف المعالجة
  - حالة العمل
  - سجل العمليات

**لتشغيل البوت:**
```bash
python main.py
```

## 📊 النتائج

- سيتم إنشاء ورقة جديدة باسم **نتائج_الاستعلام** في نفس ملف Google Sheets
- تحتوي على:
  - الاسم
  - الرقم القومي
  - مركز الانتخاب
  - العنوان
  - رقم اللجنة الفرعية
  - الرقم في الكشوف
  - الحالة (success/error)

## 🔄 المتابعة والاستئناف

البرنامج يحفظ التقدم تلقائياً:
- إذا توقف البرنامج، قم بتشغيله مرة أخرى
- سيبدأ من حيث توقف
- لن يعيد معالجة الصفوف السابقة

**لإعادة البدء من الصفر:**
```bash
rm progress.json
python main.py
```

## ⚙️ الإعدادات

يمكنك تعديل الإعدادات في بداية ملف `main.py`:

```python
SPREADSHEET_ID = "..."  # معرف Google Sheet الخاص بك
SOURCE_SHEET = "Voters"  # اسم ورقة البيانات
RESULTS_SHEET = "نتائج_الاستعلام"  # اسم ورقة النتائج
MAX_ROWS = 80000  # الحد الأقصى للصفوف
```

## 📝 ملاحظات مهمة

1. **السرعة**: البرنامج ينتظر 2-3 ثوان بين كل استعلام لتجنب حظر IP
2. **التكامل**: البرنامج يستخدم تكامل Google Sheets في Replit (لا حاجة لملف credentials.json)
3. **المتصفح**: يستخدم Chromium في وضع headless (خلفي)
4. **الأمان**: لا تشارك معرف Google Sheet مع أحد

## 🆘 استكشاف الأخطاء

### المشكلة: "لم يتم العثور على ورقة Voters"
✅ **الحل**: تأكد من تسمية الورقة بـ "Voters" بالضبط

### المشكلة: "الورقة فارغة"
✅ **الحل**: تأكد من وجود بيانات في العمود B (الأرقام القومية)

### المشكلة: "فشل الاتصال بـ Google Sheets"
✅ **الحل**: تأكد من إعداد تكامل Google Sheets في Replit

### المشكلة: "البيانات لا تُستخرج بشكل صحيح"
✅ **الحل**: 
- تحقق من صحة الأرقام القومية (14 رقم)
- قد يكون هناك تغيير في هيكل الموقع
- راجع ملف debug_screenshot_*.png للمساعدة

## 🚀 نصائح للأداء الأفضل

1. ابدأ بعدد صغير من الصفوف للاختبار (10-20 صف)
2. راقب لوحة التحكم للتأكد من أن كل شيء يعمل
3. دع البرنامج يعمل بدون انقطاع للحصول على أفضل النتائج
4. استخدم اتصال إنترنت مستقر

---

**🎯 هل تحتاج مساعدة؟**
راجع ملف `README.md` للمزيد من التفاصيل والتعليمات المتقدمة.
